{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function () {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) try {\n      if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n      if (y = 0, t) op = [op[0] & 2, t.value];\n\n      switch (op[0]) {\n        case 0:\n        case 1:\n          t = op;\n          break;\n\n        case 4:\n          _.label++;\n          return {\n            value: op[1],\n            done: false\n          };\n\n        case 5:\n          _.label++;\n          y = op[1];\n          op = [0];\n          continue;\n\n        case 7:\n          op = _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n\n        default:\n          if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n            _ = 0;\n            continue;\n          }\n\n          if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n            _.label = op[1];\n            break;\n          }\n\n          if (op[0] === 6 && _.label < t[1]) {\n            _.label = t[1];\n            t = op;\n            break;\n          }\n\n          if (t && _.label < t[2]) {\n            _.label = t[2];\n\n            _.ops.push(op);\n\n            break;\n          }\n\n          if (t[2]) _.ops.pop();\n\n          _.trys.pop();\n\n          continue;\n      }\n\n      op = body.call(thisArg, _);\n    } catch (e) {\n      op = [6, e];\n      y = 0;\n    } finally {\n      f = t = 0;\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReactMediaRecorder = exports.useReactMediaRecorder = exports.RecorderErrors = void 0;\n\nvar react_1 = require(\"react\");\n\nvar RecorderErrors;\n\n(function (RecorderErrors) {\n  RecorderErrors[\"AbortError\"] = \"media_aborted\";\n  RecorderErrors[\"NotAllowedError\"] = \"permission_denied\";\n  RecorderErrors[\"NotFoundError\"] = \"no_specified_media_found\";\n  RecorderErrors[\"NotReadableError\"] = \"media_in_use\";\n  RecorderErrors[\"OverconstrainedError\"] = \"invalid_media_constraints\";\n  RecorderErrors[\"TypeError\"] = \"no_constraints\";\n  RecorderErrors[\"NONE\"] = \"\";\n  RecorderErrors[\"NO_RECORDER\"] = \"recorder_error\";\n})(RecorderErrors = exports.RecorderErrors || (exports.RecorderErrors = {}));\n\nfunction useReactMediaRecorder(_a) {\n  var _this = this;\n\n  var _b = _a.audio,\n      audio = _b === void 0 ? true : _b,\n      _c = _a.video,\n      video = _c === void 0 ? false : _c,\n      _d = _a.onStop,\n      onStop = _d === void 0 ? function () {\n    return null;\n  } : _d,\n      _e = _a.onStart,\n      onStart = _e === void 0 ? function () {\n    return null;\n  } : _e,\n      blobPropertyBag = _a.blobPropertyBag,\n      _f = _a.screen,\n      screen = _f === void 0 ? false : _f,\n      _g = _a.mediaRecorderOptions,\n      mediaRecorderOptions = _g === void 0 ? null : _g,\n      _h = _a.customMediaStream,\n      customMediaStream = _h === void 0 ? null : _h,\n      _j = _a.stopStreamsOnStop,\n      stopStreamsOnStop = _j === void 0 ? true : _j,\n      _k = _a.askPermissionOnMount,\n      askPermissionOnMount = _k === void 0 ? false : _k;\n  var mediaRecorder = (0, react_1.useRef)(null);\n  var mediaChunks = (0, react_1.useRef)([]);\n  var mediaStream = (0, react_1.useRef)(null);\n\n  var _l = (0, react_1.useState)(\"idle\"),\n      status = _l[0],\n      setStatus = _l[1];\n\n  var _m = (0, react_1.useState)(false),\n      isAudioMuted = _m[0],\n      setIsAudioMuted = _m[1];\n\n  var _o = (0, react_1.useState)(null),\n      mediaBlobUrl = _o[0],\n      setMediaBlobUrl = _o[1];\n\n  var _p = (0, react_1.useState)(\"NONE\"),\n      error = _p[0],\n      setError = _p[1];\n\n  var getMediaStream = (0, react_1.useCallback)(function () {\n    return __awaiter(_this, void 0, void 0, function () {\n      var requiredMedia, stream_1, audioStream, stream, error_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            setStatus(\"acquiring_media\");\n            requiredMedia = {\n              audio: typeof audio === \"boolean\" ? !!audio : audio,\n              video: typeof video === \"boolean\" ? !!video : video\n            };\n            _a.label = 1;\n\n          case 1:\n            _a.trys.push([1, 9,, 10]);\n\n            if (!customMediaStream) return [3, 2];\n            mediaStream.current = customMediaStream;\n            return [3, 8];\n\n          case 2:\n            if (!screen) return [3, 6];\n            return [4, window.navigator.mediaDevices.getDisplayMedia({\n              video: video || true\n            })];\n\n          case 3:\n            stream_1 = _a.sent();\n            stream_1.getVideoTracks()[0].addEventListener(\"ended\", function () {\n              stopRecording();\n            });\n            if (!audio) return [3, 5];\n            return [4, window.navigator.mediaDevices.getUserMedia({\n              audio: audio\n            })];\n\n          case 4:\n            audioStream = _a.sent();\n            audioStream.getAudioTracks().forEach(function (audioTrack) {\n              return stream_1.addTrack(audioTrack);\n            });\n            _a.label = 5;\n\n          case 5:\n            mediaStream.current = stream_1;\n            return [3, 8];\n\n          case 6:\n            return [4, window.navigator.mediaDevices.getUserMedia(requiredMedia)];\n\n          case 7:\n            stream = _a.sent();\n            mediaStream.current = stream;\n            _a.label = 8;\n\n          case 8:\n            setStatus(\"idle\");\n            return [3, 10];\n\n          case 9:\n            error_1 = _a.sent();\n            setError(error_1.name);\n            setStatus(\"idle\");\n            return [3, 10];\n\n          case 10:\n            return [2];\n        }\n      });\n    });\n  }, [audio, video, screen]);\n  (0, react_1.useEffect)(function () {\n    if (!window.MediaRecorder) {\n      throw new Error(\"Unsupported Browser\");\n    }\n\n    if (screen) {\n      if (!window.navigator.mediaDevices.getDisplayMedia) {\n        throw new Error(\"This browser doesn't support screen capturing\");\n      }\n    }\n\n    var checkConstraints = function (mediaType) {\n      var supportedMediaConstraints = navigator.mediaDevices.getSupportedConstraints();\n      var unSupportedConstraints = Object.keys(mediaType).filter(function (constraint) {\n        return !supportedMediaConstraints[constraint];\n      });\n\n      if (unSupportedConstraints.length > 0) {\n        console.error(\"The constraints \" + unSupportedConstraints.join(\",\") + \" doesn't support on this browser. Please check your ReactMediaRecorder component.\");\n      }\n    };\n\n    if (typeof audio === \"object\") {\n      checkConstraints(audio);\n    }\n\n    if (typeof video === \"object\") {\n      checkConstraints(video);\n    }\n\n    if (mediaRecorderOptions && mediaRecorderOptions.mimeType) {\n      if (!MediaRecorder.isTypeSupported(mediaRecorderOptions.mimeType)) {\n        console.error(\"The specified MIME type you supplied for MediaRecorder doesn't support this browser\");\n      }\n    }\n\n    if (!mediaStream.current && askPermissionOnMount) {\n      getMediaStream();\n    }\n\n    return function () {\n      if (mediaStream.current) {\n        var tracks = mediaStream.current.getTracks();\n        tracks.forEach(function (track) {\n          return track.stop();\n        });\n      }\n    };\n  }, [audio, screen, video, getMediaStream, mediaRecorderOptions, askPermissionOnMount]);\n\n  var startRecording = function () {\n    return __awaiter(_this, void 0, void 0, function () {\n      var isStreamEnded;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            setError(\"NONE\");\n            if (!!mediaStream.current) return [3, 2];\n            return [4, getMediaStream()];\n\n          case 1:\n            _a.sent();\n\n            _a.label = 2;\n\n          case 2:\n            if (!mediaStream.current) return [3, 5];\n            isStreamEnded = mediaStream.current.getTracks().some(function (track) {\n              return track.readyState === \"ended\";\n            });\n            if (!isStreamEnded) return [3, 4];\n            return [4, getMediaStream()];\n\n          case 3:\n            _a.sent();\n\n            _a.label = 4;\n\n          case 4:\n            if (!mediaStream.current.active) {\n              return [2];\n            }\n\n            mediaRecorder.current = new MediaRecorder(mediaStream.current);\n            mediaRecorder.current.ondataavailable = onRecordingActive;\n            mediaRecorder.current.onstop = onRecordingStop;\n            mediaRecorder.current.onstart = onRecordingStart;\n\n            mediaRecorder.current.onerror = function () {\n              setError(\"NO_RECORDER\");\n              setStatus(\"idle\");\n            };\n\n            mediaRecorder.current.start();\n            setStatus(\"recording\");\n            _a.label = 5;\n\n          case 5:\n            return [2];\n        }\n      });\n    });\n  };\n\n  var onRecordingActive = function (_a) {\n    var data = _a.data;\n    mediaChunks.current.push(data);\n  };\n\n  var onRecordingStart = function () {\n    onStart();\n  };\n\n  var onRecordingStop = function () {\n    var chunk = mediaChunks.current[0];\n    var blobProperty = Object.assign({\n      type: chunk.type\n    }, blobPropertyBag || (video ? {\n      type: \"video/mp4\"\n    } : {\n      type: \"audio/wav\"\n    }));\n    var blob = new Blob(mediaChunks.current, blobProperty);\n    var url = URL.createObjectURL(blob);\n    setStatus(\"stopped\");\n    setMediaBlobUrl(url);\n    onStop(url, blob);\n  };\n\n  var muteAudio = function (mute) {\n    setIsAudioMuted(mute);\n\n    if (mediaStream.current) {\n      mediaStream.current.getAudioTracks().forEach(function (audioTrack) {\n        return audioTrack.enabled = !mute;\n      });\n    }\n  };\n\n  var pauseRecording = function () {\n    if (mediaRecorder.current && mediaRecorder.current.state === \"recording\") {\n      setStatus(\"paused\");\n      mediaRecorder.current.pause();\n    }\n  };\n\n  var resumeRecording = function () {\n    if (mediaRecorder.current && mediaRecorder.current.state === \"paused\") {\n      setStatus(\"recording\");\n      mediaRecorder.current.resume();\n    }\n  };\n\n  var stopRecording = function () {\n    if (mediaRecorder.current) {\n      if (mediaRecorder.current.state !== \"inactive\") {\n        setStatus(\"stopping\");\n        mediaRecorder.current.stop();\n\n        if (stopStreamsOnStop) {\n          mediaStream.current && mediaStream.current.getTracks().forEach(function (track) {\n            return track.stop();\n          });\n        }\n\n        mediaChunks.current = [];\n      }\n    }\n  };\n\n  return {\n    error: RecorderErrors[error],\n    muteAudio: function () {\n      return muteAudio(true);\n    },\n    unMuteAudio: function () {\n      return muteAudio(false);\n    },\n    startRecording: startRecording,\n    pauseRecording: pauseRecording,\n    resumeRecording: resumeRecording,\n    stopRecording: stopRecording,\n    mediaBlobUrl: mediaBlobUrl,\n    status: status,\n    isAudioMuted: isAudioMuted,\n    previewStream: mediaStream.current ? new MediaStream(mediaStream.current.getVideoTracks()) : null,\n    previewAudioStream: mediaStream.current ? new MediaStream(mediaStream.current.getAudioTracks()) : null,\n    clearBlobUrl: function () {\n      if (mediaBlobUrl) {\n        URL.revokeObjectURL(mediaBlobUrl);\n      }\n\n      setMediaBlobUrl(null);\n      setStatus(\"idle\");\n    }\n  };\n}\n\nexports.useReactMediaRecorder = useReactMediaRecorder;\n\nvar ReactMediaRecorder = function (props) {\n  return props.render(useReactMediaRecorder(props));\n};\n\nexports.ReactMediaRecorder = ReactMediaRecorder;","map":{"version":3,"sources":["/Users/stefan_rmmr/software_dev/beat_inspector/my_component/frontend/node_modules/react-media-recorder/lib/index.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","Object","defineProperty","exports","ReactMediaRecorder","useReactMediaRecorder","RecorderErrors","react_1","require","_a","_this","_b","audio","_c","video","_d","onStop","_e","onStart","blobPropertyBag","_f","screen","_g","mediaRecorderOptions","_h","customMediaStream","_j","stopStreamsOnStop","_k","askPermissionOnMount","mediaRecorder","useRef","mediaChunks","mediaStream","_l","useState","status","setStatus","_m","isAudioMuted","setIsAudioMuted","_o","mediaBlobUrl","setMediaBlobUrl","_p","error","setError","getMediaStream","useCallback","requiredMedia","stream_1","audioStream","stream","error_1","current","window","navigator","mediaDevices","getDisplayMedia","getVideoTracks","addEventListener","stopRecording","getUserMedia","getAudioTracks","forEach","audioTrack","addTrack","name","useEffect","MediaRecorder","Error","checkConstraints","mediaType","supportedMediaConstraints","getSupportedConstraints","unSupportedConstraints","keys","filter","constraint","console","join","mimeType","isTypeSupported","tracks","getTracks","track","stop","startRecording","isStreamEnded","some","readyState","active","ondataavailable","onRecordingActive","onstop","onRecordingStop","onstart","onRecordingStart","onerror","start","data","chunk","blobProperty","assign","type","blob","Blob","url","URL","createObjectURL","muteAudio","mute","enabled","pauseRecording","state","pause","resumeRecording","resume","unMuteAudio","previewStream","MediaStream","previewAudioStream","clearBlobUrl","revokeObjectURL","props","render"],"mappings":"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","sourcesContent":["\"use strict\";var __awaiter=(this&&this.__awaiter)||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value);});}\nreturn new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value));}catch(e){reject(e);}}\nfunction rejected(value){try{step(generator[\"throw\"](value));}catch(e){reject(e);}}\nfunction step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected);}\nstep((generator=generator.apply(thisArg,_arguments||[])).next());});};var __generator=(this&&this.__generator)||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1];},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),\"throw\":verb(1),\"return\":verb(2)},typeof Symbol===\"function\"&&(g[Symbol.iterator]=function(){return this;}),g;function verb(n){return function(v){return step([n,v]);};}\nfunction step(op){if(f)throw new TypeError(\"Generator is already executing.\");while(_)try{if(f=1,y&&(t=op[0]&2?y[\"return\"]:op[0]?y[\"throw\"]||((t=y[\"return\"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue;}\nif(op[0]===3&&(!t||(op[1]>t[0]&&op[1]<t[3]))){_.label=op[1];break;}\nif(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break;}\nif(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break;}\nif(t[2])_.ops.pop();_.trys.pop();continue;}\nop=body.call(thisArg,_);}catch(e){op=[6,e];y=0;}finally{f=t=0;}\nif(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true};}};Object.defineProperty(exports,\"__esModule\",{value:true});exports.ReactMediaRecorder=exports.useReactMediaRecorder=exports.RecorderErrors=void 0;var react_1=require(\"react\");var RecorderErrors;(function(RecorderErrors){RecorderErrors[\"AbortError\"]=\"media_aborted\";RecorderErrors[\"NotAllowedError\"]=\"permission_denied\";RecorderErrors[\"NotFoundError\"]=\"no_specified_media_found\";RecorderErrors[\"NotReadableError\"]=\"media_in_use\";RecorderErrors[\"OverconstrainedError\"]=\"invalid_media_constraints\";RecorderErrors[\"TypeError\"]=\"no_constraints\";RecorderErrors[\"NONE\"]=\"\";RecorderErrors[\"NO_RECORDER\"]=\"recorder_error\";})(RecorderErrors=exports.RecorderErrors||(exports.RecorderErrors={}));function useReactMediaRecorder(_a){var _this=this;var _b=_a.audio,audio=_b===void 0?true:_b,_c=_a.video,video=_c===void 0?false:_c,_d=_a.onStop,onStop=_d===void 0?function(){return null;}:_d,_e=_a.onStart,onStart=_e===void 0?function(){return null;}:_e,blobPropertyBag=_a.blobPropertyBag,_f=_a.screen,screen=_f===void 0?false:_f,_g=_a.mediaRecorderOptions,mediaRecorderOptions=_g===void 0?null:_g,_h=_a.customMediaStream,customMediaStream=_h===void 0?null:_h,_j=_a.stopStreamsOnStop,stopStreamsOnStop=_j===void 0?true:_j,_k=_a.askPermissionOnMount,askPermissionOnMount=_k===void 0?false:_k;var mediaRecorder=(0,react_1.useRef)(null);var mediaChunks=(0,react_1.useRef)([]);var mediaStream=(0,react_1.useRef)(null);var _l=(0,react_1.useState)(\"idle\"),status=_l[0],setStatus=_l[1];var _m=(0,react_1.useState)(false),isAudioMuted=_m[0],setIsAudioMuted=_m[1];var _o=(0,react_1.useState)(null),mediaBlobUrl=_o[0],setMediaBlobUrl=_o[1];var _p=(0,react_1.useState)(\"NONE\"),error=_p[0],setError=_p[1];var getMediaStream=(0,react_1.useCallback)(function(){return __awaiter(_this,void 0,void 0,function(){var requiredMedia,stream_1,audioStream,stream,error_1;return __generator(this,function(_a){switch(_a.label){case 0:setStatus(\"acquiring_media\");requiredMedia={audio:typeof audio===\"boolean\"?!!audio:audio,video:typeof video===\"boolean\"?!!video:video,};_a.label=1;case 1:_a.trys.push([1,9,,10]);if(!customMediaStream)return[3,2];mediaStream.current=customMediaStream;return[3,8];case 2:if(!screen)return[3,6];return[4,window.navigator.mediaDevices.getDisplayMedia({video:video||true,})];case 3:stream_1=(_a.sent());stream_1.getVideoTracks()[0].addEventListener(\"ended\",function(){stopRecording();});if(!audio)return[3,5];return[4,window.navigator.mediaDevices.getUserMedia({audio:audio,})];case 4:audioStream=_a.sent();audioStream.getAudioTracks().forEach(function(audioTrack){return stream_1.addTrack(audioTrack);});_a.label=5;case 5:mediaStream.current=stream_1;return[3,8];case 6:return[4,window.navigator.mediaDevices.getUserMedia(requiredMedia)];case 7:stream=_a.sent();mediaStream.current=stream;_a.label=8;case 8:setStatus(\"idle\");return[3,10];case 9:error_1=_a.sent();setError(error_1.name);setStatus(\"idle\");return[3,10];case 10:return[2];}});});},[audio,video,screen]);(0,react_1.useEffect)(function(){if(!window.MediaRecorder){throw new Error(\"Unsupported Browser\");}\nif(screen){if(!window.navigator.mediaDevices.getDisplayMedia){throw new Error(\"This browser doesn't support screen capturing\");}}\nvar checkConstraints=function(mediaType){var supportedMediaConstraints=navigator.mediaDevices.getSupportedConstraints();var unSupportedConstraints=Object.keys(mediaType).filter(function(constraint){return!supportedMediaConstraints[constraint];});if(unSupportedConstraints.length>0){console.error(\"The constraints \"+unSupportedConstraints.join(\",\")+\" doesn't support on this browser. Please check your ReactMediaRecorder component.\");}};if(typeof audio===\"object\"){checkConstraints(audio);}\nif(typeof video===\"object\"){checkConstraints(video);}\nif(mediaRecorderOptions&&mediaRecorderOptions.mimeType){if(!MediaRecorder.isTypeSupported(mediaRecorderOptions.mimeType)){console.error(\"The specified MIME type you supplied for MediaRecorder doesn't support this browser\");}}\nif(!mediaStream.current&&askPermissionOnMount){getMediaStream();}\nreturn function(){if(mediaStream.current){var tracks=mediaStream.current.getTracks();tracks.forEach(function(track){return track.stop();});}};},[audio,screen,video,getMediaStream,mediaRecorderOptions,askPermissionOnMount,]);var startRecording=function(){return __awaiter(_this,void 0,void 0,function(){var isStreamEnded;return __generator(this,function(_a){switch(_a.label){case 0:setError(\"NONE\");if(!!mediaStream.current)return[3,2];return[4,getMediaStream()];case 1:_a.sent();_a.label=2;case 2:if(!mediaStream.current)return[3,5];isStreamEnded=mediaStream.current.getTracks().some(function(track){return track.readyState===\"ended\";});if(!isStreamEnded)return[3,4];return[4,getMediaStream()];case 3:_a.sent();_a.label=4;case 4:if(!mediaStream.current.active){return[2];}\nmediaRecorder.current=new MediaRecorder(mediaStream.current);mediaRecorder.current.ondataavailable=onRecordingActive;mediaRecorder.current.onstop=onRecordingStop;mediaRecorder.current.onstart=onRecordingStart;mediaRecorder.current.onerror=function(){setError(\"NO_RECORDER\");setStatus(\"idle\");};mediaRecorder.current.start();setStatus(\"recording\");_a.label=5;case 5:return[2];}});});};var onRecordingActive=function(_a){var data=_a.data;mediaChunks.current.push(data);};var onRecordingStart=function(){onStart();};var onRecordingStop=function(){var chunk=mediaChunks.current[0];var blobProperty=Object.assign({type:chunk.type},blobPropertyBag||(video?{type:\"video/mp4\"}:{type:\"audio/wav\"}));var blob=new Blob(mediaChunks.current,blobProperty);var url=URL.createObjectURL(blob);setStatus(\"stopped\");setMediaBlobUrl(url);onStop(url,blob);};var muteAudio=function(mute){setIsAudioMuted(mute);if(mediaStream.current){mediaStream.current.getAudioTracks().forEach(function(audioTrack){return(audioTrack.enabled=!mute);});}};var pauseRecording=function(){if(mediaRecorder.current&&mediaRecorder.current.state===\"recording\"){setStatus(\"paused\");mediaRecorder.current.pause();}};var resumeRecording=function(){if(mediaRecorder.current&&mediaRecorder.current.state===\"paused\"){setStatus(\"recording\");mediaRecorder.current.resume();}};var stopRecording=function(){if(mediaRecorder.current){if(mediaRecorder.current.state!==\"inactive\"){setStatus(\"stopping\");mediaRecorder.current.stop();if(stopStreamsOnStop){mediaStream.current&&mediaStream.current.getTracks().forEach(function(track){return track.stop();});}\nmediaChunks.current=[];}}};return{error:RecorderErrors[error],muteAudio:function(){return muteAudio(true);},unMuteAudio:function(){return muteAudio(false);},startRecording:startRecording,pauseRecording:pauseRecording,resumeRecording:resumeRecording,stopRecording:stopRecording,mediaBlobUrl:mediaBlobUrl,status:status,isAudioMuted:isAudioMuted,previewStream:mediaStream.current?new MediaStream(mediaStream.current.getVideoTracks()):null,previewAudioStream:mediaStream.current?new MediaStream(mediaStream.current.getAudioTracks()):null,clearBlobUrl:function(){if(mediaBlobUrl){URL.revokeObjectURL(mediaBlobUrl);}\nsetMediaBlobUrl(null);setStatus(\"idle\");},};}\nexports.useReactMediaRecorder=useReactMediaRecorder;var ReactMediaRecorder=function(props){return props.render(useReactMediaRecorder(props));};exports.ReactMediaRecorder=ReactMediaRecorder;"]},"metadata":{},"sourceType":"script"}